<div class="row notice">
    <div class="section">
        <div class="notice-message">
            <div id="items" class="notice-text"></div>
        </div>
    </div>
</div>

<div class="row">
    <div class="section">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Manage</th>
                </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
                <tr>
                    <td colspan="2">
                        <button id="add_new" class="btn small round green">
                            + Add New</button>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>

<div class="row">
    <div class="section">
        <div class="full-width-forms hide">

            <div class="col-1-3">
                <label>
                    <input type="text" id="name" placeholder="Site">
                </label>
            </div>
            <div class="col-1-3">
                <label>
                    <textarea id="url" placeholder="Paste the url" rows="4"></textarea>
                </label>
            </div>
            <div class="col-1-3">
                <label>
                    <input type="text" id="icon" placeholder="Paste the icon font awesome class">
                </label>
            </div>
            <div class="clear"></div>

            <div class="col-1-3 space"></div>
            <div class="col-1-3">
                <label>
                    <button id="save" class="btn solid green" disabled>save</button>
                </label>
            </div>
            <div class="col-1-3 space"></div>
            <div class="clear"></div>
        </div>
    </div>
</div>
<script>

    const PageHelper = app.PageHelper

    function setTable() {
        const index = PageHelper.prototype.index
        const tbody = PD('table > tbody')
        const el = tbody.getElements()
        let html = ''

        if (typeof PageHelper.prototype.data[index] == 'undefined')
            return

        PageHelper.prototype.data[index].forEach((data, i) => {
            html += `<tr><td>${data.name}</td>` + // this kind of string
                `<td><button class="btn tiny orange round" data-index="${i}">edit</button>` + // supports multiline
                `<button class="btn tiny red round" data-index="${i}">delete</button><td></tr>`// but means add extra text nodes
        })

        tbody.setContent(html)

        PD('button.orange', el).listen('click', PageHelper.showForm)
        PD('button.red', el).listen('click', PageHelper.showAlert)
    }

    PageHelper.sectionItemWarning()

    setTable()

    PageHelper.setAddNew()
    PageHelper.setFormEvents()
</script>